# Roguelike 关卡：随机池设计与 Build 强度控制

流量原因：内容可无限扩展（“每次都不一样”），天然适配短视频/直播反复刷。

## 1) 随机池不是“随机”，而是“可控的组合生成”

把关卡拆成多个 **可组合的池**，而不是一个大杂烩：

- **房间池**：普通战斗 / 精英 / 商店 / 事件 / 补给  
- **奖励池**：金币 / 升级 / 遗物 / 临时 Buff  
- **敌人池**：按 biome、层数、单位体型与技能标签分组

关键：每个条目都要有 **标签与约束**，否则你只能靠“权重玄学”救火。

常用的约束字段（表驱动）：

- `minFloor/maxFloor`：出现区间  
- `exclusiveTags`：互斥（同一层只出一次）  
- `cooldown`：最近 N 次不出现（防止连出商店/连出事件）  
- `ensureEvery`：每 X 层至少一次（避免“缺商店导致后期没法成型”）

## 2) Build 强度控制：不要直接“削弱玩家”，要“改风险与节奏”

玩家 Build 崩坏通常不是“数值太大”，而是 **增长曲线失控**：

- 稀有升级太密 → 叠乘过快  
- 防御成长滞后 → 被一波秒  
- 关键功能（位移/穿透/吸血）出现过晚 → 手感差、退游

做法：先定义一个 **目标强度曲线**（每层的期望）：

- 输出：期望 DPS 增长 10~15%/层  
- 生存：有效血量或减伤增长 8~12%/层  
- 控场：关键功能在第 2~3 层必须能拿到“入门版本”

当玩家领先时，不要“砍属性”，更好的手段是：

- **提高风险**：更强敌人组合、更少补给、更高精英密度  
- **改变收益结构**：领先时给“选择空间”，落后时给“直接力量”  
- **控制叠乘**：把同类加成改为加法（同组加法、跨组乘法）

## 3) 一个很好用的生成策略：预算 + 软纠偏

每层设定预算（示例）：

- 战斗房间占比 60%  
- 事件房间占比 25%  
- 商店/补给占比 15%  

然后再根据玩家状态做软纠偏：

- 玩家落后：提高补给/直接数值奖励的权重  
- 玩家领先：提高“高风险高回报”的权重（例如精英/诅咒奖励）

一句话总结：**池负责“多样性”，预算负责“稳定性”，纠偏负责“公平感”。**

